# archlint

> [üá¨üáß English version](README.en.md)

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –≥—Ä–∞—Ñ–æ–≤ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ Go.

archlint –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –∏—Å–ø–æ–ª—å–∑—É—è –¥–≤–∞ —Ç–∏–ø–∞ –≥—Ä–∞—Ñ–æ–≤:
- **–°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –≥—Ä–∞—Ñ** - —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Å–≤—è–∑–∏
- **–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –≥—Ä–∞—Ñ** - –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —á–µ—Ä–µ–∑ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ—Ç–æ–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –≥—Ä–∞—Ñ–æ–≤ –∏–∑ Go –∫–æ–¥–∞
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –≥—Ä–∞—Ñ–æ–≤ –∏–∑ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–æ–∫ —Ç–µ—Å—Ç–æ–≤
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–æ—Ä–º–∞—Ç DocHub YAML
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è sequence –¥–∏–∞–≥—Ä–∞–º–º PlantUML
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ wildcards –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## Contribution

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏. –ö–∞–∂–¥–∞—è —Ñ–∏—á–∞ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é Claude Code.

```bash
git clone https://github.com/mshogin/archlint
cd archlint
make implement
```

`make implement` –∑–∞–ø—É—Å–∫–∞–µ—Ç Claude Code –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π –∏–∑ `specs/todo/`. Claude Code –≤–æ–∑—å–º–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –≤ —Ä–∞–±–æ—Ç—É, –ø–µ—Ä–µ–Ω–µ—Å–µ—Ç –µ—ë –≤ `specs/inprogress/`, –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç –∏ –∑–∞–ø—É—à–∏—Ç (—á—Ç–æ–±—ã —É–≤–µ–¥–æ–º–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤), –∞ –∑–∞—Ç–µ–º —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π:

```
specs/
‚îú‚îÄ‚îÄ todo/         # –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, –æ–∂–∏–¥–∞—é—â–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ inprogress/   # –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ —Ä–∞–±–æ—Ç–µ
‚îî‚îÄ‚îÄ done/         # –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ò–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤

```bash
git clone https://github.com/mshogin/archlint
cd archlint
make install
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç `archlint` –≤ `$GOPATH/bin`.

### –°–±–æ—Ä–∫–∞

```bash
make build
```

–ë–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ `bin/archlint`.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞

–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –∏ —Å—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (–ø–∞–∫–µ—Ç—ã, —Ç–∏–ø—ã, —Ñ—É–Ω–∫—Ü–∏–∏, –º–µ—Ç–æ–¥—ã) –∏ –∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

```bash
archlint collect . -o architecture.yaml
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
Analyzing code: . (language: go)
Found components: 95
  - package: 5
  - struct: 23
  - function: 30
  - method: 21
  - external: 15
Found links: 129
‚úì Graph saved to architecture.yaml
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥—Ä–∞—Ñ–∞:**
```yaml
components:
  cmd/archlint:
    title: main
    entity: package
  cmd/archlint.main:
    title: main
    entity: function
  internal/analyzer.GoAnalyzer:
    title: GoAnalyzer
    entity: struct

links:
  cmd/archlint:
    - to: cmd/archlint.main
      type: contains
  cmd/archlint.main:
    - to: internal/analyzer.NewGoAnalyzer
      type: calls

contexts:
  cmd:
    title: cmd
    location: Architecture/cmd
    components:
      - cmd/archlint
      - cmd/archlint.main
```

### 2. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ –≥—Ä–∞—Ñ–∞

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –∏–∑ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–æ–∫ —Ç–µ—Å—Ç–æ–≤, –ø–æ–∫–∞–∑—ã–≤–∞—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ—Ç–æ–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

**–®–∞–≥ 1:** –î–æ–±–∞–≤—å—Ç–µ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫—É –≤ —Ç–µ—Å—Ç—ã:

```go
import "github.com/mshogin/archlint/pkg/tracer"

func TestProcessOrder(t *testing.T) {
    trace := tracer.StartTrace("TestProcessOrder")
    defer func() {
        trace.Save("traces/test_process_order.json")
    }()

    // –¢—Ä–∞—Å—Å–∏—Ä—É–µ–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    tracer.Enter("OrderService.ProcessOrder")
    result, err := service.ProcessOrder(order)
    tracer.Exit("OrderService.ProcessOrder", err)

    // –ø—Ä–æ–≤–µ—Ä–∫–∏...
}
```

**–®–∞–≥ 2:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã:

```bash
go test -v ./...
```

**–®–∞–≥ 3:** –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã:

```bash
archlint trace ./traces -o contexts.yaml
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- `contexts.yaml` - –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –¥–ª—è DocHub
- `*.puml` - PlantUML sequence –¥–∏–∞–≥—Ä–∞–º–º—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Makefile

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
make help

# –°–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
make build

# –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ –¥–ª—è —Å–∞–º–æ–≥–æ archlint
make collect

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
make fmt

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
make test

# –û—á–∏—Å—Ç–∏—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
make clean
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
archlint/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ archlint/          # CLI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ       ‚îú‚îÄ‚îÄ main.go        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ       ‚îú‚îÄ‚îÄ collect.go     # –∫–æ–º–∞–Ω–¥–∞ collect
‚îÇ       ‚îî‚îÄ‚îÄ trace.go       # –∫–æ–º–∞–Ω–¥–∞ trace
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ model/             # –ú–æ–¥–µ–ª—å –≥—Ä–∞—Ñ–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ model.go       # Graph, Node, Edge, DocHub
‚îÇ   ‚îî‚îÄ‚îÄ analyzer/          # –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –∫–æ–¥–∞
‚îÇ       ‚îî‚îÄ‚îÄ go.go          # GoAnalyzer (AST –ø–∞—Ä—Å–∏–Ω–≥)
‚îú‚îÄ‚îÄ pkg/
‚îÇ   ‚îî‚îÄ‚îÄ tracer/            # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏
‚îÇ       ‚îú‚îÄ‚îÄ trace.go       # –°–±–æ—Ä —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–æ–∫
‚îÇ       ‚îî‚îÄ‚îÄ context_generator.go  # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ go.mod
‚îú‚îÄ‚îÄ Makefile
‚îî‚îÄ‚îÄ README.md
```

## –ü—Ä–∏–º–µ—Ä—ã

### –ê–Ω–∞–ª–∏–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

archlint –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–±—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞:

```bash
make collect
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: `graph/architecture.yaml` —Å –ø–æ–ª–Ω—ã–º –≥—Ä–∞—Ñ–æ–º –ø—Ä–æ–µ–∫—Ç–∞.

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DocHub

–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ YAML —Ñ–∞–π–ª—ã —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å [DocHub](https://dochub.info/):

```yaml
# dochub.yaml
contexts:
  $imports:
    - architecture.yaml
    - contexts.yaml
```

## –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –≥—Ä–∞—Ñ

- **–£–∑–ª—ã (components)**: –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
  - `package` - Go –ø–∞–∫–µ—Ç—ã
  - `struct` - —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
  - `interface` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
  - `function` - —Ñ—É–Ω–∫—Ü–∏–∏
  - `method` - –º–µ—Ç–æ–¥—ã
  - `external` - –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **–†–µ–±—Ä–∞ (links)**: —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
  - `contains` - –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å (–ø–∞–∫–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∏–ø)
  - `calls` - –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏/–º–µ—Ç–æ–¥–∞
  - `uses` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –≤ –ø–æ–ª–µ
  - `embeds` - –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ —Ç–∏–ø–∞
  - `import` - –∏–º–ø–æ—Ä—Ç –ø–∞–∫–µ—Ç–∞

### –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –≥—Ä–∞—Ñ

- **Trace**: —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–∞
  - `test_name` - –∏–º—è —Ç–µ—Å—Ç–∞
  - `calls` - –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–æ–≤
    - `event`: "enter" | "exit_success" | "exit_error"
    - `function` - –∏–º—è —Ñ—É–Ω–∫—Ü–∏–∏
    - `depth` - —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏

## –°–≤—è–∑—å —Å aiarch

archlint —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–æ–≤ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ [aiarch](https://github.com/mshogin/aiarch).

**–ß—Ç–æ –ù–ï –≤–∫–ª—é—á–µ–Ω–æ –≤ archlint:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≥—Ä–∞—Ñ–æ–≤
- –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (fan-out, coupling –∏ —Ç.–¥.)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª

–î–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –º–µ—Ç—Ä–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ [aiarch](https://github.com/mshogin/aiarch).

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

- GitHub: https://github.com/mshogin/archlint
- –°–≤—è–∑–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç: https://github.com/mshogin/aiarch
